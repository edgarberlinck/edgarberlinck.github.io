<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  	<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="//www.parsecdn.com/js/parse-1.3.2.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <title>Welcome to My Workout</title>

    <style type="text/css">
      body {
        font-family: 'Open Sans', sans-serif;
      }

      span {
      	font-family: 'Open Sans', sans-serif;
      }

      .well-lg {
      	margin-top: 1em;
      }

      .button-group {
        margin-top: 1em;
      }

      .footer {
		  position: absolute;
		  bottom: 0;
		  /* Set the fixed height of the footer here */
		  height: 60px;
		  text-align: center;
		  background-color: gradient(top,#e8e8e8 0,#f5f5f5 100%);

	  }
    </style>

  </head>
  <body>
    <form id="signupform">
    	<div class="container">
        <div class="well well-lg">
          <div class="page-header">
            <h1>Welcome to My Workout.</h1>
            <small>New user</small>
          </div>
          <h3>Username</h3>
          <div class="input-group">
            <span class="input-group-addon" id="username"><span class="fa fa-user"></span></span>
            <input id="iusername" type="text" class="form-control" placeholder="Username" aria-describedby="username">
          </div>

          <h3>e-mail</h3>
          <div class="input-group">
            <span class="input-group-addon" id="email">@</span>
            <input id="iemail" type="text" class="form-control" placeholder="email adress" aria-describedby="email">
          </div>

          <h3>Password</h3>
          <div class="input-group">
            <span class="input-group-addon" id="password"><span class="fa fa-key"></span></span>
            <input id="ipassword" type="password" class="form-control" placeholder="password" aria-describedby="password">
          </div>
          <h3>Confirm your Password</h3>
          <div class="input-group">
            <span class="input-group-addon" id="password_confirmation"><span class="fa fa-key"></span></span>
            <input id="ipassword_confirmation" type="password" class="form-control" placeholder="confirm your password" aria-describedby="password-confirmation">
          </div>

          <div class="button-group">
            <button type="button" class="btn btn-lg" aria-label="Laft Align" onclick="register()">
              <span>Register</span>
            </button>
          </div>
        </div>
      </div>
    </form>
  </body>
  
  <script type="text/javascript">

    function register() {
      var user = new Object();
      user.username = document.getElementById("iusername").value;
      user.password = document.getElementById("ipassword").value;
      user.email = document.getElementById("iemail").value;
      
      if (!validate(user)) {
        return false;
      }

      Parse.initialize("FE9ZFfQcp2tSVznOzsYQAbtFiAXk8x9i4rYVezn3", "zCLnaeuwGEaycCCESfXAtqlrNrMAVqbezUxN1kzS");
      Parse.Cloud.run('register', user, {
      success: function(response) {
        Parse.User.logIn(user.username, user.password, {
          success: function(result) {
            window.location = "home.html";
          },

          error : function (result) {
            showWarnings(result);
          }
        });
        
      },
      error: function(error) {
        console.log(error);
      }
      });
    }
    
    function validate(user) {
      var isValid = true;
      var warning = "<ul>";
      var password_confirmation = document.getElementById("ipassword_confirmation").value;

      if (user.username === "") {
        isValid = false;
        warning += "<li> You must pick up one username for you.";
      }

      if (user.email === "") {
        isValid = false;
        warning += "<li> Please, inform your email."; 
      }

      if (user.password === "") {
        isValid = false;
        warning += "<li> You must choose a password";
      }

      if (user.password !== password_confirmation) {
        isValid = false;
        warning += "<li> Passwords not match";  
      }

      warning += "</ul>";

      if (!isValid)
        showWarnings(warning);
      return isValid;
    }

    function showWarnings(warnings) {
      alert(warnings);
    }
  </script>

 </html>
